//Global Variables 
var currentScene = 0;
var currentPlayer = 0;


//bitmoji
var drawBody = function(bitmojiX,bitmojiY,bitmojiH)
{

beginShape();//body
vertex(bitmojiX+(bitmojiH/100*100),bitmojiY+bitmojiH/100*(251+80));
vertex(bitmojiX+bitmojiH/100*(100),bitmojiY+bitmojiH/100*(312+80));
vertex(bitmojiX+bitmojiH/100*(121),bitmojiY+bitmojiH/100*(314+80));
vertex(bitmojiX+bitmojiH/100*(121),bitmojiY+bitmojiH/100*(280+80));
vertex(bitmojiX+bitmojiH/100*(135),bitmojiY+bitmojiH/100*(282+80));
vertex(bitmojiX+bitmojiH/100*(143),bitmojiY+bitmojiH/100*(353+80));
vertex(bitmojiX+bitmojiH/100*(258),bitmojiY+bitmojiH/100*(353+80));
vertex(bitmojiX+bitmojiH/100*(258),bitmojiY+bitmojiH/100*(290+80));
vertex(bitmojiX+bitmojiH/100*(273),bitmojiY+bitmojiH/100*(290+80));
vertex(bitmojiX+bitmojiH/100*(273),bitmojiY+bitmojiH/100*(315+80));
vertex(bitmojiX+bitmojiH/100*(296),bitmojiY+bitmojiH/100*(315+80));
vertex(bitmojiX+bitmojiH/100*(296),bitmojiY+bitmojiH/100*(251+80));
endShape(CLOSE);
};
var drawHead = function(bitmojiX,bitmojiY,bitmojiH)
{
fill(255,224,189);
ellipse(bitmojiX+bitmojiH/100*(200),bitmojiY+bitmojiH/100*(172+88),bitmojiH/100*(134),bitmojiH/100*(155));//head


arc(bitmojiX+(bitmojiH/100*165),bitmojiY+bitmojiH/100*(132+118),bitmojiH/100*(50),bitmojiH/100*(30),(230),(300)); // left eyebrow



fill(255, 255, 255);
ellipse(bitmojiX+bitmojiH/100*(165),bitmojiY+bitmojiH/100*(131+118),bitmojiH/100*(20),bitmojiH/100*(15));//left eye 

fill(130, 61, 0);
ellipse(bitmojiX+bitmojiH/100*(165),bitmojiY+bitmojiH/100*(131+118),bitmojiH/100*(8),bitmojiH/100*(8));//left pupil 
fill(0, 0, 0);
ellipse(bitmojiX+bitmojiH/100*(165),bitmojiY+bitmojiH/100*(131+118),bitmojiH/100*(4),bitmojiH/100*(4));//left pupil 
noFill();
arc(bitmojiX+bitmojiH/100*(237),bitmojiY+bitmojiH/100*(132+118),bitmojiH/100*(50),bitmojiH/100*(30),230,300); // right eyebrow

fill(255, 255, 255);
ellipse(bitmojiX+bitmojiH/100*(237),bitmojiY+bitmojiH/100*(131+118),bitmojiH/100*(20),bitmojiH/100*(15));//right eye 
fill(130, 61, 0);
ellipse(bitmojiX+bitmojiH/100*(237),bitmojiY+bitmojiH/100*(131+118),bitmojiH/100*(8),bitmojiH/100*(8));//right pupil 
fill(0, 0, 0);
ellipse(bitmojiX+bitmojiH/100*(237),bitmojiY+bitmojiH/100*(131+118),bitmojiH/100*(4),bitmojiH/100*(4));//right pupil 
noFill();
bezier(bitmojiX+bitmojiH/100*(212), bitmojiY+bitmojiH/100*(136+115), bitmojiX+bitmojiH/100*(204), bitmojiY+bitmojiH/100*(309), bitmojiX+bitmojiH/100*(172), bitmojiY+bitmojiH/100*(271), bitmojiX+bitmojiH/100*(192), bitmojiY+bitmojiH/100*(247));//nose


fill(255, 255, 255);//mouth
beginShape();
vertex(bitmojiX+bitmojiH/100*(171),bitmojiY+bitmojiH/100*(190+110));
vertex(bitmojiX+bitmojiH/100*(232),bitmojiY+bitmojiH/100*(190+110));
vertex(bitmojiX+bitmojiH/100*(227),bitmojiY+bitmojiH/100*(213+110));
vertex(bitmojiX+bitmojiH/100*(181),bitmojiY+bitmojiH/100*(213+110));
endShape(CLOSE);


fill(115, 65, 4);
ellipse(bitmojiX+bitmojiH/100*(197),bitmojiY+bitmojiH/100*(201),bitmojiH/100*(119),bitmojiH/100*(39));//hair


resetMatrix();
fill(228, 234, 237);// hat
arc(bitmojiX+bitmojiH/100*(196),bitmojiY+bitmojiH/100*(173),bitmojiH/100*(104),bitmojiH/100*(107),(161),(375));//hat back
fill(0, 0, 0);
ellipse(bitmojiX+bitmojiH/100*(196),bitmojiY+bitmojiH/100*(186),bitmojiH/100*(106),bitmojiH/100*(20));//hat top

fill(255,255,255);

textSize(20*bitmojiH/100);
fill(0, 0, 0);
text("TDX",bitmojiX+bitmojiH/100*(176),bitmojiY+bitmojiH/100*(157));
};
var bitmoji = function(bitmojiX,bitmojiY,bitmojiH){
drawBody(bitmojiX,bitmojiY,bitmojiH);
drawHead(bitmojiX,bitmojiY,bitmojiH);
};

var drawBitmoji = function(h, x, y) {

  //hair
  fill(3, 3, 3); //hair color
  quad(x + (h / 50 * 155), y + (h / 50 * 145), x + (h / 50 * 255), y + (h / 50 * 145), x + (h / 50 * 275), y + (h / 50 * 250), x + (h / 50 * 130), y + (h / 50 * 250)); //hair

  //head
  fill(156, 114, 72);
  ellipse(x + (h / 50 * 200), y + (h / 50 * 200), h / 50 * 88, h / 50 * 100); //head shape

  //eyes
  fill(255, 255, 255); //eye whites
  ellipse(x + (h / 50 * 185), y + (h / 50 * 185), h / 50 * 8, h / 50 * 8); //left eye white
  ellipse(x + (h / 50 * 215), y + (h / 50 * 185), h / 50 * 8, h / 50 * 8); //right eye white
  fill(3, 3, 3); //iris color
  ellipse(x + (h / 50 * 185), y + (h / 50 * 185), h / 50 * 5, h / 50 * 5); //left iris
  ellipse(x + (h / 50 * 215), y + (h / 50 * 185), h / 50 * 5, h / 50 * 5); //right iris
  
  //mouth
  fill(189, 56, 107);
  ellipse(x + (h / 50 * 200), y + (h / 50 * 223), h / 50 * 26, h / 50 * 11); //bottom lip
  fill(111, 79, 29);
  ellipse(x + (h / 50 * 200), y + (h / 50 * 219), h / 50 * 27, h / 50 * 9); //top lip
  
  //sweater
  fill(229, 181, 232);
  quad(x + (h / 50 * 110), y + (h / 50 * 250), x + (h / 50 * 290), y + (h / 50 * 250), x + (h / 50 * 303), y + (h / 50 * 380), x + (h / 50 * 103), y + (h / 50 * 380)); 

  //letters on sweater
  fill(255, 255, 255);
  textSize(h / 50 * 51);
  text("ML", x + (h / 50 * 171), y + (h / 50 * 315));
};

//Start Button
var Button = function(config) {
    this.x = config.x || 0;
    this.y = config.y || 0;
    this.width = config.width || 150;
    this.height = config.height || 50;
    this.label = config.label || "Click";
    this.onClick = config.onClick || function() {};
};

//draw button
Button.prototype.draw = function() {
    fill(167, 202, 204);
    rect(this.x, this.y, this.width, this.height, 5);
    fill(0, 0, 0);
    textSize(19);
    textAlign(LEFT, TOP);
    text(this.label, this.x+10, this.y+this.height/4);
};

//is mouse inside the button
Button.prototype.isMouseInside = function() {
    return mouseX > this.x &&
           mouseX < (this.x + this.width) &&
           mouseY > this.y &&
           mouseY < (this.y + this.height);
};

//what happens when mouse clicked
Button.prototype.handleMouseClick = function() {
    if (this.isMouseInside()) {
        this.onClick();
        
    }
};

//the start button
var startButton = new Button({
    x: 130,
    y: 300,
    label: "        Start!",
    onClick: function() {
    currentScene = 1;
    }
    
});

//Gameboard peices
var Gameboard =[
    [0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0]
    ];
/* 
0  6  12  18  24  30  36
1  7  13  19  25  31  37
2  8  14  20  26  32  38
3  9  15  21  27  33  39
4  10 16  22  28  34  40
5  11 17  23  29  35  41

*/
var hoverEffect = function ()
    {
    //first row hightlight
    if(mouseX > 25 && mouseX < 75)
        {
        if(currentPlayer === 0)
            {
            fill(255, 0, 0);
            ellipse(50,80,25,25);
            }
        if(currentPlayer === 1)
            {
            fill(240, 255, 74);
            ellipse(50,80,25,25);
            }
        }
        //2nd row highlight
        else if(mouseX > 75 && mouseX < 125)
        {
        if(currentPlayer === 0)
            {
            fill(255, 0, 0);
            ellipse(100,80,25,25);
            }
        if(currentPlayer === 1)
            {
            fill(240, 255, 74);
            ellipse(100,80,25,25);
            }
        }
        else if(mouseX > 126 && mouseX < 175)
        {
        if(currentPlayer === 0)
            {
            fill(255, 0, 0);
            ellipse(150,80,25,25);
            }
        if(currentPlayer === 1)
            {
            fill(240, 255, 74);
            ellipse(150,80,25,25);
            }
        }
        else if(mouseX > 176 && mouseX < 225)
        {
        if(currentPlayer === 0)
            {
            fill(255, 0, 0);
            ellipse(200,80,25,25);
            }
        if(currentPlayer === 1)
            {
            fill(240, 255, 74);
            ellipse(200,80,25,25);
            }
        }
        else if(mouseX > 226 && mouseX < 275)
        {
        if(currentPlayer === 0)
            {
            fill(255, 0, 0);
            ellipse(250,80,25,25);
            }
        if(currentPlayer === 1)
            {
            fill(240, 255, 74);
            ellipse(250,80,25,25);
            }
        }
        else if(mouseX > 276 && mouseX < 325)
        {
        if(currentPlayer === 0)
            {
            fill(255, 0, 0);
            ellipse(300,80,25,25);
            }
        if(currentPlayer === 1)
            {
            fill(240, 255, 74);
            ellipse(300,80,25,25);
            }
        }
        else if(mouseX > 326 && mouseX < 375)
        {
        if(currentPlayer === 0)
            {
            fill(255, 0, 0);
            ellipse(350,80,25,25);
            }
        if(currentPlayer === 1)
            {
            fill(240, 255, 74);
            ellipse(350,80,25,25);
            }
        }
    };

var board = function()
    {
    fill(64, 61, 255);
    rect(25,100,350,300);
    fill(255, 255, 255);
    //1st row ( decided not to make adjustable rows and columns because we felt they were unneeded)
    ellipse(50,100+25,25,25);
    ellipse(100,100+25,25,25); 
    ellipse(150,100+25,25,25); 
    ellipse(200,100+25,25,25); 
    ellipse(250,100+25,25,25); 
    ellipse(300,100+25,25,25); 
    ellipse(350,100+25,25,25); 
    //2nd row
    ellipse(50,150+25,25,25);
    ellipse(100,150+25,25,25); 
    ellipse(150,150+25,25,25); 
    ellipse(200,150+25,25,25); 
    ellipse(250,150+25,25,25); 
    ellipse(300,150+25,25,25); 
    ellipse(350,150+25,25,25); 
    //3rd row
    ellipse(50,200+25,25,25);
    ellipse(100,200+25,25,25); 
    ellipse(150,200+25,25,25); 
    ellipse(200,200+25,25,25); 
    ellipse(250,200+25,25,25); 
    ellipse(300,200+25,25,25); 
    ellipse(350,200+25,25,25);
    //4th row
    ellipse(50,250+25,25,25);
    ellipse(100,250+25,25,25); 
    ellipse(150,250+25,25,25); 
    ellipse(200,250+25,25,25); 
    ellipse(250,250+25,25,25); 
    ellipse(300,250+25,25,25); 
    ellipse(350,250+25,25,25); 
    //5th row
    ellipse(50,300+25,25,25);
    ellipse(100,300+25,25,25); 
    ellipse(150,300+25,25,25); 
    ellipse(200,300+25,25,25); 
    ellipse(250,300+25,25,25); 
    ellipse(300,300+25,25,25); 
    ellipse(350,300+25,25,25); 
    //6th row
    ellipse(50,350+25,25,25);
    ellipse(100,350+25,25,25); 
    ellipse(150,350+25,25,25); 
    ellipse(200,350+25,25,25); 
    ellipse(250,350+25,25,25); 
    ellipse(300,350+25,25,25); 
    ellipse(350,350+25,25,25); 
    };
var playersTurn = function()
    {
        if(currentPlayer === 0)
        {
            fill(255, 0, 0);
            textSize(25);
            text("Red Player's Turn!", 90,35);
        }
        else if(currentPlayer === 1)
        {    
            fill(240, 255, 74);
            textSize(25);
            text("Yellow Player's Turn!", 90,35);
        }
        
    };

//Splash Screen
var splashScreen = function ()
{
    background(87, 156, 108);
    fill(0, 0, 255);
    bitmoji(50,70,30);
    drawBitmoji(17,183,66);
    
    textSize(35);
    text("Connect Four!", 70,68);
    textSize(20);
    text("Be the first to connect 4 to win the game!",34,210,304,100);
    startButton.draw();
};

//Game Scene
var gameScreen = function ()
{
    background(186, 186, 186);
    board();
    playersTurn();
    hoverEffect();
    fill(30, 0, 255);
    bitmoji(-1,-17,25);
    drawBitmoji(15,285,-18);
};

//GameOver Screen
var gameOver = function()
{
     background(255, 178, 178);
     if(currentPlayer=== 0){
     fill(255, 0, 0);
     textSize(30);
     text("Red Player Won!!", 85,118);
     fill(30, 0, 255);
     bitmoji(91,119,56);
     
     fill(255, 255, 255);
    ellipse(300,184,100,47);
    fill(0, 0, 0);
    textSize(14);
    text("Great Job!",266,176);
     //ad celebrating Bitmoji
     }
     else if(currentPlayer=== 1){
     background(250, 244, 200);
     fill(255, 225, 0);
     textSize(30);
     text("Yellow Player Won!!",72,110);
     drawBitmoji(29,74,113);
    ellipse(300,184,100,47);
    fill(0, 0, 0);
    textSize(20);
    text("YAY!!!",271,171);
     //ad celebrating Bitmoji
     }
};

var checkWin = function(player){
    for (var row = 0; row < 6; row++) {
        for (var col = 0; col < 4; col++) {
            if (Gameboard[row][col] === player &&
                Gameboard[row][col+1] === player &&
                Gameboard[row][col+2] === player &&
                Gameboard[row][col+3] === player) {
                    return true;
                  }
                }
              }
            return false;
    };

//this is where ball drop is going to be inside
mouseClicked = function(){
if(currentScene===0){
    startButton.handleMouseClick();
    }
    else if(currentScene ===1){
        if(currentPlayer === 0)//red turn
        {
        
        currentPlayer = 1;
        }
        else if(currentPlayer === 1)//yellow turn
        {
            
            currentPlayer = 0;
        }
    }

if (mouseIsPressed && currentPlayer === 0) {
    if (mouseX > 25 && mouseX < 75) {
        Gameboard[0].push(currentPlayer);
    } else if (mouseX > 75 && mouseX < 125) {
        Gameboard[1].push(currentPlayer);
    } else if (mouseX > 126 && mouseX < 175) {
        Gameboard[2].push(currentPlayer);
    } else if (mouseX > 176 && mouseX < 225) {
        Gameboard[3].push(currentPlayer);
    } else if (mouseX > 226 && mouseX < 275) {
        Gameboard[4].push(currentPlayer);
    } else if (mouseX > 276 && mouseX < 325) {
        Gameboard[5].push(currentPlayer);
    } else if (mouseX > 326 && mouseX < 375) {
        Gameboard[6].push(currentPlayer);
    }
}
};


//Scene Change
var draw = function() {
    if(currentScene===0){splashScreen();}
    else if(currentScene === 1){gameScreen();}
    else if(currentScene === 2){gameOver();}
};
